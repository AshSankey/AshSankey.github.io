<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Interactive Dashboard with Treemap</title>
    <link rel="icon" href="favicon.png" type="image/png" />

    <meta
      name="description"
      content="Our intuitive tools allow you to convert complex datasets into visually striking treemaps within seconds. Simply upload your hierarchical data, and watch it transform into a dynamic chart that highlights proportions, trends, and relationships—perfect for financial analyses, market shares, or resource allocation."
    />
    <meta
      property="og:title"
      content="Our intuitive tools allow you to convert complex datasets into visually striking treemaps within seconds. Simply upload your hierarchical data, and watch it transform into a dynamic chart that highlights proportions, trends, and relationships—perfect for financial analyses, market shares, or resource allocation."
    />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://www.Viroet.com/Tree.html" />
    <meta
      property="og:description"
      content="Make beautiful flow diagrams. Export them as images or SVG."
    />
    <meta property="og:site_name" content="www.Viroet.com/Tree.html" />
    <meta property="og:locale" content="en_US" />
    <meta
      property="og:image"
      content="https://www.Viroet.com/Apple%20FY24%20Income%20Statement.png"
    />
    <meta property="og:image:type" content="image/png" />
    <meta property="og:image:width" content="2700" />
    <meta property="og:image:height" content="1350" />
    <meta
      property="og:image:alt"
      content="Screenshot of the Viroet diagram-building interface"
    />

    <!-- Include ECharts -->
    <script src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>

    <!-- Include Handsontable -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/handsontable/dist/handsontable.full.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/handsontable/dist/handsontable.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.1/xlsx.full.min.js"></script>

    <style>
      /* Global Styles */
      body {
        font-family: "Roboto", sans-serif;
        margin: 5;
        padding: 0;
        background: linear-gradient(
          to right,
          #000e18,
          #0d0142
        ); /* Subtle background color */
        color: #333;
        height: 100vh;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }

      /* Layout Sections */
      #top-section {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px;
        background: linear-gradient(
          to right,
          #000e18,
          #0d0142
        ); /* Subtle background color */
        color: #fff;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        font-weight: 500;
        width: 100%; /* Increase width to extend beyond parent */
      }

      #bottom-section {
        display: flex;
        flex: 1;
        gap: 20px;
        padding: 20px;
        overflow: hidden;
      }

      /* Left Section for Table */
      #left-section {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: 20px;
      }

      #left-section table {
        width: 100%;
        border-collapse: collapse;
        border-radius: 8px; /* Rounded corners for modern design */
        overflow: hidden; /* Ensure rounded corners work with overflow */
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* Subtle shadow for modern look */
        background-color: #ffffff; /* Table background color */
      }

      #left-section thead {
        background-color: #4caf50; /* Modern header color */
        color: white; /* Contrast text color */
        position: sticky;
        top: 0;
        z-index: 1;
      }

      #left-section th,
      #left-section td {
        padding: 12px 15px; /* Larger padding for better readability */
        text-align: left;
        border-bottom: 1px solid #ddd; /* Maintain separation between rows */
      }

      #left-section th {
        text-transform: uppercase;
        font-size: 14px;
        letter-spacing: 0.5px;
      }
      #left-section thead {
        display: table; /* Align header to table width */
        width: 100%; /* Match the table width */
      }

      #left-section tbody {
        display: block !important;
        max-height: calc(
          40px * 12
        ) !important; /* Adjust based on actual row height */
        overflow-y: auto !important;
        width: 100% !important;
      }

      #left-section tbody tr {
        display: table;
        width: 100%;
        table-layout: fixed; /* Consistent column widths */
        height: 40px; /* Set a fixed row height */
      }

      #left-section tbody tr:hover {
        background-color: #f1f1f1; /* Row hover effect */
      }

      #left-section tbody::-webkit-scrollbar {
        width: 8px; /* Narrow scrollbar */
      }

      #left-section tbody::-webkit-scrollbar-thumb {
        background: #888; /* Scrollbar thumb color */
        border-radius: 4px;
      }

      #left-section tbody::-webkit-scrollbar-thumb:hover {
        background: #555;
      }

      #left-section tbody::-webkit-scrollbar-track {
        background: #f1f1f1; /* Scrollbar track color */
      }

      /* Right Section for Output and Controls */
      #right-section {
        flex: 1.5;
        display: flex;
        flex-direction: column;
        gap: 20px;
      }

      button:hover {
        background-color: #2980b9;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }

      button:active {
        background-color: #2980b9;
        transform: scale(0.98);
      }

      button:focus {
        outline: none;
      }

      button:disabled {
        background-color: #bdc3c7;
        cursor: not-allowed;
      }

      .slider-container {
        display: flex;
        align-items: center; /* Aligns elements vertically in the center */
        justify-content: flex-start; /* Default: Aligns content to the left */
        padding: 7px 13px;
        background-color: #f9f9f9;
        border-radius: 10px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        font-family: "Roboto", sans-serif;
        font-size: 14px;
        color: #2c3e50;
        max-width: 400px;
        margin: 0 auto; /* Centers the container horizontally */
      }

      /* Add this to shift the slider to the right */
      .slider-container {
        margin-left: auto; /* Pushes the slider to the right */
        margin-right: 0; /* Ensures no extra space on the right */
      }

      /* Chart and Table Container */
      #table-container {
        height: 100%;
      }

      #chart-container {
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: #fff;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      }

      /* Chart Styling */
      #chart {
        width: 100%;
        height: 100%;
        border-radius: 8px;
        background-color: #fff;
      }

      /* Header Styling */
      .header {
        font-size: 32px;
        font-weight: 700;
        text-align: center;
        margin-bottom: 20px;
        color: #2c3e50;
        text-transform: uppercase;
      }

      #footer {
        display: flex; /* Use flexbox for alignment */
        justify-content: center; /* Center text horizontally */
        align-items: center; /* Center text vertically */
        background: linear-gradient(to right, #3498db, #2ecc71, #f39c12);
        color: #0d063a;
        font-size: 14px; /* Adjust font size */
        position: relative;
        bottom: 0;
        width: 100%;
        height: 50px; /* Footer height */
        margin: 0; /* Remove any default margins */
        padding: 0; /* Remove extra space inside the footer */
        box-sizing: border-box; /* Ensure padding doesn’t affect height */
      }

      /* Utility Styles */
      .hide {
        display: none;
      }

      .show {
        display: block;
      }

      input[type="file"] {
        display: none;
      }

      #controls-ribbon {
        display: flex; /* Aligns all controls in a row */
        flex-wrap: wrap; /* Allows wrapping to the next line if space is limited */
        align-items: center; /* Vertically aligns all controls */
        justify-content: flex-start; /* Aligns controls to the left */
        gap: 10px; /* Consistent spacing between controls */
        padding: 15px;
        background-color: #f4f4f4;
        border-radius: 10px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      }

      .control-section,
      .slider-container {
        display: flex; /* Aligns label and input horizontally */
        align-items: center; /* Vertically centers the items */
        gap: 10px; /* Adds spacing between label and input */
      }

      .label {
        font-size: 14px;
        font-weight: 500;
        color: #333;
        white-space: nowrap; /* Prevents labels from wrapping */
      }

      .modern-input {
        padding: 8px 12px;
        font-size: 14px;
        border: 1px solid #ccc;
        border-radius: 6px;
        width: 200px; /* Ensures consistent input width */
      }

      #border-width {
        margin: 0; /* Removes any default margins */
      }

      #border-width-value {
        font-size: 14px;
        color: #333;
      }

      .input-container {
        display: flex;
        align-items: center;
      }

      .modern-input {
        padding: 8px 12px;
        font-size: 14px;
        border: 1px solid #ccc;
        border-radius: 6px;
        width: 200px; /* Ensures consistent input width */
      }

      .modern-input:focus {
        outline: none;
        border-color: #007bff;
        box-shadow: 0 0 4px rgba(0, 123, 255, 0.4);
      }
      #category-color {
        padding: 8px;
        font-size: 14px;
        border: 1px solid #ccc;
        border-radius: 6px;
        width: 150px;
      }

      #portion-color-picker {
        width: 40px;
        height: 40px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
      }

      .ribbon-button {
        padding: 10px 16px;
        font-size: 14px;
        font-weight: 500;
        color: #fff;
        background-color: #007bff;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        transition: background-color 0.3s ease;
      }

      .ribbon-button:hover {
        background-color: #0056b3;
      }

      /* Slider Styling */
      .slider-container {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      #border-width {
        appearance: none;
        width: 150px;
        height: 6px;
        background: #ddd;
        border-radius: 5px;
        outline: none;
      }

      #border-width::-webkit-slider-thumb {
        appearance: none;
        width: 14px;
        height: 14px;
        background: #007bff;
        border-radius: 50%;
        cursor: pointer;
      }

      #border-width-value {
        font-size: 14px;
        font-weight: 500;
        color: #333;
      }

      /* Color Picker Styling */
      .color-picker-container {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .modern-color-picker {
        width: 40px;
        height: 40px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
      }

      /* Export Controls */
      .export-controls {
        display: flex;
        align-items: center;
        gap: 20px;
      }

      .ribbon-button {
        padding: 10px 16px;
        font-size: 14px;
        font-weight: 500;
        color: #fff;
        background-color: #007bff;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        transition: background-color 0.3s ease;
      }

      .ribbon-button:hover {
        background-color: #0056b3;
      }

      /* Dropdown Styling */
      .dropdown {
        position: relative;
        z-index: 10; /* Ensures dropdown stays above other elements */
      }

      .dropdown-button {
        padding: 8px 12px; /* Smaller padding for a compact look */
        font-size: 14px;
        font-weight: 500;
        color: #fff;
        background-color: #007bff;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        transition: background-color 0.3s ease;
      }

      .dropdown-button:hover {
        background-color: #0056b3;
      }

      .dropdown-content {
        display: none;
        position: absolute;
        top: 100%;
        left: 0;
        width: 150px; /* Smaller width for a compact container */
        background-color: #fff;
        border: 1px solid #ccc;
        border-radius: 6px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        overflow: hidden;
        z-index: 1000; /* Ensures dropdown stays on top */
      }

      .dropdown-content button {
        padding: 8px 12px; /* Smaller padding for compact options */
        font-size: 13px; /* Slightly smaller font size */
        color: #333;
        background-color: #fff;
        border: none;
        text-align: left;
        width: 100%;
        cursor: pointer;
        transition: background-color 0.3s ease;
      }

      .dropdown-content button:hover {
        background-color: #f4f4f4;
      }

      .dropdown:hover .dropdown-content {
        display: block;
      }

      /* Media Query for Mobile Screens */

      /* Default Logo Styling */
      #logo {
        height: 40px; /* Adjust height for visibility */
        width: auto; /* Maintain aspect ratio */
        margin: 0; /* Remove unnecessary margins */
        display: block; /* Ensure block-like behavior */
      }

      /* Logo Container Styling */
      #logo-container {
        display: flex;
        justify-content: flex-start; /* Align logo to the left */
        align-items: center; /* Vertically center logo within container */
        padding: 10px; /* Add padding for spacing */
        width: 100%; /* Ensure the container spans full width */
        box-sizing: border-box; /* Include padding in the container width */
      }

      /* Modal Overlay */
      .overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 999;
      }

      /* Responsive Dialog */
      .responsive-dialog {
        max-width: 90%;
        width: 1000px;
        margin: 0 auto;
        border: none;
        border-radius: 10px;
        padding: 20px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        background: white;
        z-index: 1000;
        position: relative;

        /* Centering Styles */
        position: fixed; /* Ensure the dialog is positioned relative to the viewport */
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
      }

      /* Dialog Title */
      .dialog-title {
        margin-bottom: 10px;
        font-size: 18px;
        font-weight: bold;
        text-align: center;
      }

      /* Dialog Content for Link */
      .dialog-content {
        word-break: break-all; /* Break long words for scroll */
        overflow-x: auto; /* Enable horizontal scrolling */
        white-space: nowrap; /* Prevent text from wrapping */
        background: #f9f9f9;
        padding: 10px;
        border-radius: 5px;
        margin-bottom: 15px;
        text-align: center;
        font-size: 14px;
        max-width: 100%; /* Restrict width within the modal */
        border: 1px solid #ddd;
      }

      /* Link Style */
      .dialog-content a {
        color: #3498db; /* Blue color for the link */
        text-decoration: none; /* Remove underline */
      }

      .dialog-content a:hover {
        text-decoration: underline; /* Add underline on hover */
      }

      /* Dialog Buttons */
      .dialog-buttons {
        display: flex;
        justify-content: space-between;

        gap: 10px;
      }

      .button-primary {
        background: #3498db;
        color: white;
        border: none;
        padding: 10px 15px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 14px;
        flex: 1;
        text-align: center;
      }

      .button-primary:hover {
        background: #2980b9;
      }

      .button-secondary {
        background: #e74c3c;
        color: white;
        border: none;
        padding: 10px 15px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 14px;
        flex: 1;
        text-align: center;
      }

      .button-secondary:hover {
        background: #c0392b;
      }

      td.selected {
        background-color: #d3d3d3; /* Highlight color */
      }

      .nav-link {
        text-decoration: none;
        color: #ffffff; /* White text for clarity */
        font-weight: 500; /* Slightly lighter weight for readability */
        padding: 12px 24px; /* Balanced padding for a modern button feel */
        border-radius: 12px; /* Increased border-radius for a more modern, smooth look */
        background-color: transparent; /* Transparent background initially */
        font-family: "Roboto", sans-serif; /* Clean, modern font */
        letter-spacing: 0.5px; /* Subtle letter-spacing for clarity */
        display: inline-block; /* Keeps the link inline with other elements */
        text-transform: uppercase; /* Uppercase text for a more tech-focused vibe */
        transition: color 0.3s ease; /* Smooth transition for text color */
        margin-right: 38px; /* Adds a small gap on the left */
      }

      /* Hover state */
      .nav-link:hover {
        color: #007bff; /* Change text color to blue on hover */
      }

      /* Active or selected state */
      .nav-link.active {
        color: #007bff; /* Text remains blue for active links */
        font-weight: 600; /* Optional: Slightly bolder text for active state */
      }

      .switch-ai-button {
        display: inline-flex; /* Flexbox for aligning text and logo */
        align-items: center;
        justify-content: center;
        padding: 8px 20px;
        border: none;
        border-radius: 24px; /* Rounded button */
        background: linear-gradient(
          45deg,
          #ffffff,
          #c87aff
        ); /* Gradient colors */
        color: #000000; /* White text */
        font-family: "Roboto", sans-serif;
        font-size: 14px;
        font-weight: 600;
        letter-spacing: 0.5px;
        text-transform: uppercase;
        cursor: pointer;
        transition: transform 0.2s ease, box-shadow 0.3s ease;
        margin-left: 850px; /* Move the button to the right */
      }

      .switch-ai-button img {
        width: 29px; /* Adjust size of the logo */
        height: 29px;
        margin-right: 5px; /* Space between logo and text */
      }

      .switch-ai-button:hover {
        transform: translateY(-2px); /* Slight lift on hover */
        box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2); /* Glow effect */
      }

      .switch-ai-button:active {
        transform: translateY(0); /* Reset lift on click */
        box-shadow: none; /* Remove shadow on click */
      }
      #add-row-button {
        padding: 10px 16px;
        font-size: 14px;
        font-weight: 500;
        color: #fff;
        background-color: #28a745; /* Green color for positive action */
        border: none;
        border-radius: 6px;
        cursor: pointer;
        transition: background-color 0.3s ease, transform 0.2s ease;
      }

      #add-row-button:hover {
        background-color: #218838; /* Darker green on hover */
      }

      #add-row-button:active {
        transform: scale(0.98); /* Slightly shrink on click */
      }

      #add-row-button:focus {
        outline: none;
        box-shadow: 0 0 4px rgba(40, 167, 69, 0.8); /* Green focus glow */
      }
    </style>
  </head>

  <body>
    <div id="top-section" id="logo-container">
      <img src="TreeMAP_transparent-.png" alt="Logo" id="logo" />

      <!-- Button with logo -->
      <button class="switch-ai-button">
        <img src="tree assets/ai-svgrepo-com (1).svg" alt="AI Logo" /> Switch On
      </button>

      <a href="index.html" class="nav-link">public diagrams</a>
    </div>

    <div id="controls-ribbon">
      <!-- Title Input Section -->
      <div class="control-section">
        <label for="treemap-title" class="label">Title:</label>

        <div class="input-container">
          <input
            type="text"
            id="treemap-title"
            placeholder="Enter a title"
            class="modern-input"
          />
        </div>
      </div>

      <!-- Border Width Slider -->
      <div class="slider-container">
        <label for="border-width">Border Width:</label>
        <input
          type="range"
          id="border-width"
          min="0"
          max="10"
          step="1"
          value="1"
        />
        <span id="border-width-value">1</span>
      </div>

      <!-- Color Picker -->
      <div class="control-section">
        <div class="color-picker-container">
          <label for="color-picker">Choose Color:</label>
          <input
            type="color"
            id="color-picker"
            class="modern-color-picker"
            value="#FFFFFF"
          />
        </div>
      </div>

      <!-- Export Buttons -->
      <div class="export-controls">
        <button id="toggle-percentage" class="ribbon-button">
          Show Percentage
        </button>
        <div class="control-section">
          <label for="category-color">Category:</label>
          <select id="category-color">
            <!-- Options will be dynamically populated -->
          </select>
          <input type="color" id="portion-color-picker" value="#ff0000" />
          <button id="apply-color" class="ribbon-button">Apply Color</button>
        </div>

        <div class="dropdown">
          <button class="dropdown-button">Save Options</button>
          <div class="dropdown-content">
            <button id="save-png">Save as PNG</button>
            <button id="save-jpg">Save as JPG</button>
            <button id="save-excel">Save as Excel</button>
            <button id="create-share-link" class="ribbon-button">
              Create Share Link
            </button>
          </div>
        </div>
      </div>
    </div>

    <div id="bottom-section">
      <!-- Left Section: Table -->
      <div id="left-section">
        <table id="custom-table">
          <thead>
            <tr>
              <th>Category</th>
              <th>Value</th>
              <th>Parent</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td contenteditable="true">Corporate</td>
              <td contenteditable="true">1200</td>
              <td contenteditable="true"></td>
            </tr>
            <tr>
              <td contenteditable="true">Marketing</td>
              <td contenteditable="true">500</td>
              <td contenteditable="true">Corporate</td>
            </tr>
            <tr>
              <td contenteditable="true">Social Media</td>
              <td contenteditable="true">200</td>
              <td contenteditable="true">Marketing</td>
            </tr>
            <tr>
              <td contenteditable="true">Email Campaigns</td>
              <td contenteditable="true">150</td>
              <td contenteditable="true">Marketing</td>
            </tr>
            <tr>
              <td contenteditable="true">Content Creation</td>
              <td contenteditable="true">150</td>
              <td contenteditable="true">Marketing</td>
            </tr>
            <tr>
              <td contenteditable="true">Sales</td>
              <td contenteditable="true">400</td>
              <td contenteditable="true">Corporate</td>
            </tr>
            <tr>
              <td contenteditable="true">B2B Sales</td>
              <td contenteditable="true">300</td>
              <td contenteditable="true">Sales</td>
            </tr>
            <tr>
              <td contenteditable="true">B2C Sales</td>
              <td contenteditable="true">100</td>
              <td contenteditable="true">Sales</td>
            </tr>
            <tr>
              <td contenteditable="true">Operations</td>
              <td contenteditable="true">300</td>
              <td contenteditable="true">Corporate</td>
            </tr>
            <tr>
              <td contenteditable="true">Logistics</td>
              <td contenteditable="true">150</td>
              <td contenteditable="true">Operations</td>
            </tr>
            <tr>
              <td contenteditable="true">Procurement</td>
              <td contenteditable="true">100</td>
              <td contenteditable="true">Operations</td>
            </tr>
            <tr>
              <td contenteditable="true">Quality Assurance</td>
              <td contenteditable="true">50</td>
              <td contenteditable="true">Operations</td>
            </tr>
            <tr>
              <td contenteditable="true">IT Department</td>
              <td contenteditable="true">1000</td>
              <td contenteditable="true"></td>
            </tr>
            <tr>
              <td contenteditable="true">Software Development</td>
              <td contenteditable="true">600</td>
              <td contenteditable="true">IT Department</td>
            </tr>
            <tr>
              <td contenteditable="true">Frontend Development</td>
              <td contenteditable="true">250</td>
              <td contenteditable="true">Software Development</td>
            </tr>
            <tr>
              <td contenteditable="true">Backend Development</td>
              <td contenteditable="true">300</td>
              <td contenteditable="true">Software Development</td>
            </tr>
            <tr>
              <td contenteditable="true">Testing and QA</td>
              <td contenteditable="true">50</td>
              <td contenteditable="true">Software Development</td>
            </tr>
            <tr>
              <td contenteditable="true">Infrastructure</td>
              <td contenteditable="true">400</td>
              <td contenteditable="true">IT Department</td>
            </tr>
            <tr>
              <td contenteditable="true">Cloud Services</td>
              <td contenteditable="true">200</td>
              <td contenteditable="true">Infrastructure</td>
            </tr>
            <tr>
              <td contenteditable="true">Networking</td>
              <td contenteditable="true">150</td>
              <td contenteditable="true">Infrastructure</td>
            </tr>
            <tr>
              <td contenteditable="true">Cybersecurity</td>
              <td contenteditable="true">50</td>
              <td contenteditable="true">Infrastructure</td>
            </tr>
            <tr>
              <td contenteditable="true">Human Resources</td>
              <td contenteditable="true">400</td>
              <td contenteditable="true"></td>
            </tr>
            <tr>
              <td contenteditable="true">Recruitment</td>
              <td contenteditable="true">200</td>
              <td contenteditable="true">Human Resources</td>
            </tr>
            <tr>
              <td contenteditable="true">Employee Training</td>
              <td contenteditable="true">150</td>
              <td contenteditable="true">Human Resources</td>
            </tr>
            <tr>
              <td contenteditable="true">Payroll and Benefits</td>
              <td contenteditable="true">50</td>
              <td contenteditable="true">Human Resources</td>
            </tr>
          </tbody>
        </table>
        <button id="add-row-button">Add Row</button>
      </div>
      <div
        id="insights-section"
        style="
          padding: 10px;
          background-color: #f9f9f9;
          border-radius: 6px;
          box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        "
      >
        <h3></h3>
        <ul id="insights-list"></ul>
      </div>

      <!-- Right Section: Output and Controls -->
      <div id="right-section">
        <!-- ECharts -->
        <div id="chart-container">
          <div id="chart"></div>
        </div>

        <dialog id="getLinkDialog" class="responsive-dialog">
          <p class="dialog-title">Here is your shareable link:</p>
          <div id="linkTargetDiv" class="dialog-content"></div>
          <div class="dialog-buttons">
            <button id="copyLinkButton" class="button-primary">
              Copy Link
            </button>
            <button id="closeDialog" class="button-secondary">Close</button>
          </div>
        </dialog>

        <div id="modal-overlay" class="overlay"></div>
      </div>
    </div>
    <div id="footer">2024 Viroet. All rights reserved.</div>

    <script>
      // ECharts Initialization
      const chartContainer = document.getElementById("chart");
      const chart = echarts.init(chartContainer);

      // DOM Elements for Dynamic Updates
      const borderWidthSlider = document.getElementById("border-width");
      const borderWidthValue = document.getElementById("border-width-value");
      const colorPicker = document.getElementById("color-picker");
      const titleInput = document.getElementById("treemap-title");
      const categoryDropdown = document.getElementById("category-color");
      const portionColorPicker = document.getElementById(
        "portion-color-picker"
      );
      let showPercentage = false;

      // Function to Update Chart
      const updateChart = () => {
        const tableRows = document.querySelectorAll("#custom-table tbody tr");
        const parentMap = new Map();

        const selectedCategory = categoryDropdown.value;
        const selectedColor = portionColorPicker.value;

        tableRows.forEach((row) => {
          const cells = row.querySelectorAll("td");
          const category = cells[0].textContent.trim();
          const value = parseFloat(cells[1].textContent.trim()) || 0;
          const parent = cells[2].textContent.trim();

          if (parent) {
            if (!parentMap.has(parent)) {
              parentMap.set(parent, { children: [] });
            }
            parentMap.get(parent).children.push({
              name: category,
              value,
              itemStyle:
                category === selectedCategory ? { color: selectedColor } : {},
            });
          } else {
            if (!parentMap.has(category)) {
              parentMap.set(category, { children: [] });
            }
          }
        });

        const nodes = [];
        parentMap.forEach((data, category) => {
          nodes.push({
            name: category,
            value: data.children.reduce((acc, child) => acc + child.value, 0),
            children: data.children,
            itemStyle:
              category === selectedCategory ? { color: selectedColor } : {},
          });
        });

        const totalValue = nodes.reduce((acc, node) => acc + node.value, 0);

        chart.setOption({
          title: {
            text:
              titleInput.value ||
              "Revenue Breakdown Across Organizational Hierarchies",
            left: "center",
          },
          tooltip: {
            trigger: "item",
            formatter: (params) => {
              const percentage = ((params.value / totalValue) * 100).toFixed(2);
              return showPercentage
                ? `${params.name}: ${params.value} (${percentage}%)`
                : `${params.name}: ${params.value}`;
            },
          },
          series: [
            {
              type: "treemap",
              data: nodes,
              label: {
                show: true,
                formatter: (params) => {
                  const percentage = (
                    (params.value / totalValue) *
                    100
                  ).toFixed(2);
                  return showPercentage
                    ? `${params.name}\n(${percentage}%)`
                    : `${params.name}`;
                },
              },
              itemStyle: {
                borderWidth: parseInt(borderWidthSlider.value, 10),
                borderColor: colorPicker.value,
              },
            },
          ],
        });
      };

      // Add Row Functionality
      document
        .getElementById("add-row-button")
        .addEventListener("click", () => {
          const tableBody = document.querySelector("#custom-table tbody");
          const newRow = document.createElement("tr");
          newRow.innerHTML = `
    <td contenteditable="true"></td>
    <td contenteditable="true"></td>
    <td contenteditable="true"></td>
  `;
          tableBody.appendChild(newRow);

          // Attach event listeners for chart updates and cell selection
          newRow.querySelectorAll("td").forEach((cell) => {
            // Chart updates on input
            cell.addEventListener("input", () => {
              updateChart();
              populateCategoryDropdown(); // Ensure dropdown is updated dynamically
            });

            // Selection logic
            cell.addEventListener("click", (event) => {
              if (!event.shiftKey) clearSelection(); // Clear selection unless Shift is held
              selectedCells.add(cell);
              cell.classList.add("selected");
            });
          });

          populateCategoryDropdown(); // Update dropdown after adding a row
        });

      // Populate Category Dropdown
      const populateCategoryDropdown = () => {
        const tableRows = document.querySelectorAll("#custom-table tbody tr");
        const categories = new Set();

        tableRows.forEach((row) => {
          const cells = row.querySelectorAll("td");
          const category = cells[0].textContent.trim();
          if (category) {
            categories.add(category);
          }
        });

        categoryDropdown.innerHTML = ""; // Clear existing options
        categories.forEach((category) => {
          const option = document.createElement("option");
          option.value = category;
          option.textContent = category;
          categoryDropdown.appendChild(option);
        });
      };

      // Handle Input Changes
      const handleInputChange = () => {
        borderWidthValue.textContent = `${borderWidthSlider.value}px`;
        updateChart();
      };

      // Event Listeners
      borderWidthSlider.addEventListener("input", handleInputChange);
      colorPicker.addEventListener("input", handleInputChange);
      titleInput.addEventListener("input", updateChart);

      document
        .getElementById("toggle-percentage")
        .addEventListener("click", () => {
          showPercentage = !showPercentage;
          const button = document.getElementById("toggle-percentage");
          button.textContent = showPercentage
            ? "Hide Percentage"
            : "Show Percentage";
          updateChart();
        });

      document
        .getElementById("apply-color")
        .addEventListener("click", updateChart);

      // Dynamically Update Chart When Table Data Changes
      document
        .querySelectorAll("#custom-table td[contenteditable]")
        .forEach((cell) => {
          cell.addEventListener("input", () => {
            populateCategoryDropdown();
            updateChart();
          });
        });

      // Populate Dropdown on Load
      populateCategoryDropdown();

      // Initial Chart Update
      updateChart();
    </script>

    <script>
      // Function to create a shareable link
      document
        .getElementById("create-share-link")
        .addEventListener("click", () => {
          // Extract data from the custom table
          const tableRows = document.querySelectorAll("#custom-table tbody tr");
          const tableData = [];

          tableRows.forEach((row) => {
            const cells = row.querySelectorAll("td");
            const category = cells[0].textContent.trim();
            const value = cells[1].textContent.trim();
            const parent = cells[2].textContent.trim();

            if (category || value || parent) {
              tableData.push([category, value, parent]);
            }
          });

          // Extract additional settings
          const settings = {
            borderWidth: document.getElementById("border-width").value,
            borderColor: document.getElementById("color-picker").value,
            chartTitle: document.getElementById("treemap-title").value,
            selectedCategory:
              document.getElementById("category-color").value || null,
            selectedColor:
              document.getElementById("portion-color-picker").value || null,
          };

          // Encode the table data and settings
          const encodedData = encodeURIComponent(
            JSON.stringify({ tableData, settings })
          );

          // Create a sharable link
          const baseURL = window.location.origin + window.location.pathname; // Current page's base URL
          const publicLink = `${baseURL}?data=${encodedData}`;

          // Display the link in a dialog
          const dialog = document.getElementById("getLinkDialog");
          const overlay = document.getElementById("modal-overlay");
          const linkTargetDiv = document.getElementById("linkTargetDiv");

          linkTargetDiv.innerHTML = `<a href="${publicLink}" target="_blank">${publicLink}</a>`;
          dialog.showModal();
          overlay.style.display = "block";

          // Update the "Copy Link" button to copy the correct link
          document
            .getElementById("copyLinkButton")
            .setAttribute("data-link", publicLink);
        });

      // Function to handle "Copy Link" button
      document
        .getElementById("copyLinkButton")
        .addEventListener("click", () => {
          const publicLink = document
            .getElementById("copyLinkButton")
            .getAttribute("data-link");
          navigator.clipboard
            .writeText(publicLink)
            .then(() => alert("Link copied to clipboard!"))
            .catch((err) => console.error("Failed to copy link:", err));
        });

      // Check if the URL contains a data parameter
      const urlParams = new URLSearchParams(window.location.search);
      const chartData = urlParams.get("data");

      if (chartData) {
        // Decode the JSON string
        const decodedData = JSON.parse(decodeURIComponent(chartData));
        const { tableData, settings } = decodedData;

        // Populate the custom table with the decoded data
        const tbody = document.querySelector("#custom-table tbody");
        tbody.innerHTML = ""; // Clear existing rows

        tableData.forEach(([category, value, parent]) => {
          const row = document.createElement("tr");

          row.innerHTML = `
        <td contenteditable="true">${category}</td>
        <td contenteditable="true">${value}</td>
        <td contenteditable="true">${parent}</td>
      `;

          tbody.appendChild(row);
        });

        // Apply settings
        document.getElementById("border-width").value = settings.borderWidth;
        document.getElementById("color-picker").value = settings.borderColor;
        document.getElementById("treemap-title").value = settings.chartTitle;

        if (settings.selectedCategory && settings.selectedColor) {
          document.getElementById("category-color").value =
            settings.selectedCategory;
          document.getElementById("portion-color-picker").value =
            settings.selectedColor;
        }

        // Update the chart to reflect the new data and settings
        updateChart();
      }

      // Close the modal when the "Close" button is clicked
      document.getElementById("closeDialog").addEventListener("click", () => {
        const dialog = document.getElementById("getLinkDialog");
        const overlay = document.getElementById("modal-overlay");
        dialog.close();
        overlay.style.display = "none";
      });

      // Close the modal when clicking the overlay
      document.getElementById("modal-overlay").addEventListener("click", () => {
        const dialog = document.getElementById("getLinkDialog");
        const overlay = document.getElementById("modal-overlay");
        dialog.close();
        overlay.style.display = "none";
      });
    </script>

    <script>
      let isMouseDown = false;
      let selectedCells = new Set();

      // Clear selection
      function clearSelection() {
        selectedCells.forEach((cell) => cell.classList.remove("selected"));
        selectedCells.clear();
      }

      // Handle mouse down on a cell
      function handleMouseDown(event, cell) {
        isMouseDown = true;
        clearSelection();
        selectCell(cell);
      }

      // Handle mouse over a cell (dragging)
      function handleMouseOver(event, cell) {
        if (isMouseDown) {
          selectCell(cell);
        }
      }

      // Handle mouse up (end dragging)
      function handleMouseUp() {
        isMouseDown = false;
      }

      // Select a cell
      function selectCell(cell) {
        if (!selectedCells.has(cell)) {
          selectedCells.add(cell);
          cell.classList.add("selected");
        }
      }

      // Handle deletion
      function deleteSelectedCells() {
        selectedCells.forEach((cell) => {
          cell.textContent = ""; // Clear cell content
        });
        clearSelection();
        updateChart(); // Update the graph dynamically
      }

      // Attach event listeners to cells
      document.querySelectorAll("#custom-table td").forEach((cell) => {
        cell.addEventListener("mousedown", (event) =>
          handleMouseDown(event, cell)
        );
        cell.addEventListener("mouseover", (event) =>
          handleMouseOver(event, cell)
        );
        cell.addEventListener("mouseup", handleMouseUp);
      });

      // Attach event listener for delete key
      document.addEventListener("keydown", (event) => {
        if (
          (event.key === "Delete" || event.key === "Backspace") &&
          selectedCells.size > 0
        ) {
          deleteSelectedCells();
        }
      });

      // Ensure mouseup clears the drag state
      document.addEventListener("mouseup", handleMouseUp);

      // Function to handle paste event
      function handlePaste(event) {
        event.preventDefault(); // Prevent default paste behavior

        const clipboardData = event.clipboardData || window.clipboardData;
        const pastedData = clipboardData.getData("text"); // Get pasted data as plain text
        const rows = pastedData.split("\n").filter((row) => row.trim() !== ""); // Split into rows

        // Find the starting cell (first selected cell)
        const allCells = Array.from(
          document.querySelectorAll("#custom-table tbody td")
        );
        const startCell = Array.from(selectedCells)[0]; // Use the first selected cell
        if (!startCell) {
          alert("Please select a starting cell before pasting.");
          return;
        }

        const startIndex = allCells.indexOf(startCell);
        if (startIndex === -1) return; // No valid starting cell

        // Get the number of columns in the table
        const columnsPerRow = startCell.parentNode.cells.length;

        // Loop through rows and columns to paste data
        let currentRowIndex = Math.floor(startIndex / columnsPerRow);
        rows.forEach((row) => {
          const values = row.split("\t"); // Split row into columns
          let currentCellIndex = startIndex % columnsPerRow;

          values.forEach((value) => {
            const cellIndex =
              currentRowIndex * columnsPerRow + currentCellIndex;
            const cell = allCells[cellIndex];

            if (cell) {
              cell.textContent = value.trim(); // Set cell content
            }
            currentCellIndex++;
          });

          currentRowIndex++;
        });

        updateChart(); // Refresh the graph after pasting
        populateCategoryDropdown(); // Update dropdown if categories change
      }

      // Add paste event listener to the table
      document
        .querySelector("#custom-table")
        .addEventListener("paste", handlePaste);

      // Save as PNG
      document.getElementById("save-png").addEventListener("click", () => {
        const imgData = chart.getDataURL({
          type: "png",
          backgroundColor: "#ffffff", // Set to white or any desired color
        });
        const a = document.createElement("a");
        a.href = imgData;
        a.download = "chart.png";
        a.click();
      });

      // Save as JPG
      document.getElementById("save-jpg").addEventListener("click", () => {
        const imgData = chart.getDataURL({
          type: "jpg",
          backgroundColor: "#ffffff", // Set to white or any desired color
        });
        const a = document.createElement("a");
        a.href = imgData;
        a.download = "chart.jpg";
        a.click();
      });

      // Save as Excel
      document.getElementById("save-excel").addEventListener("click", () => {
        const tableRows = document.querySelectorAll("#custom-table tbody tr");
        const tableData = [];

        // Extract table data
        tableRows.forEach((row) => {
          const cells = row.querySelectorAll("td");
          const rowData = Array.from(cells).map((cell) =>
            cell.textContent.trim()
          );
          tableData.push(rowData);
        });

        // Create a workbook and a worksheet
        const workbook = XLSX.utils.book_new();
        const worksheet = XLSX.utils.aoa_to_sheet([
          ["Category", "Value", "Parent"], // Add column headers
          ...tableData,
        ]);

        // Append the worksheet to the workbook
        XLSX.utils.book_append_sheet(workbook, worksheet, "Table Data");

        // Export the workbook to an Excel file
        XLSX.writeFile(workbook, "table_data.xlsx");
      });
    </script>

    <script>
      // Select the AI switch button
      const aiSwitchButton = document.querySelector(".switch-ai-button");

      // Flag to track AI state
      let isAiEnabled = false;

      // Event listener for AI switch button
      aiSwitchButton.addEventListener("click", () => {
        isAiEnabled = !isAiEnabled;

        // Update button text
        aiSwitchButton.innerHTML = isAiEnabled
          ? '<img src="tree assets/ai-svgrepo-com (1).svg" alt="AI Logo" /> Switch Off'
          : '<img src="tree assets/ai-svgrepo-com (1).svg" alt="AI Logo" /> Switch On';

        // Perform AI actions
        if (isAiEnabled) {
          enableAiFeatures();
        } else {
          disableAiFeatures();
        }
      });

      // Function to enable AI features
      function enableAiFeatures() {
        console.log("AI features enabled.");
        autoUpdateChart();
        suggestData();
        highlightErrors();
        performAdvancedAnalysis(); // Add advanced analysis
        renderAdditionalCharts(); // Add new charts to insights
      }

      // Function to disable AI features
      function disableAiFeatures() {
        console.log("AI features disabled.");
        clearSuggestions();
        clearHighlights();
        disableDynamicUpdates();
      }

      function renderAdditionalCharts() {
        const insightsSection = document.getElementById("insights-section");

        // Clear existing charts before rendering new ones
        let chartsContainer = document.getElementById("ai-charts-container");
        if (chartsContainer) {
          chartsContainer.remove();
        }

        // Create a container for the new charts
        chartsContainer = document.createElement("div");
        chartsContainer.id = "ai-charts-container";
        chartsContainer.style.display = "flex";
        chartsContainer.style.flexWrap = "wrap";
        chartsContainer.style.gap = "20px";
        insightsSection.appendChild(chartsContainer);

        // Bar Chart
        const barChartDiv = document.createElement("div");
        barChartDiv.style.width = "400px";
        barChartDiv.style.height = "300px";
        barChartDiv.id = "bar-chart";
        chartsContainer.appendChild(barChartDiv);
        renderBarChart(barChartDiv);
      }

      // Function to render a bar chart
      function renderBarChart(container) {
        const chart = echarts.init(container);
        const data = extractTableData();

        const option = {
          title: { text: "Top Categories", left: "center" },
          xAxis: {
            type: "category",
            data: data.topCategories.map((c) => c.category),
          },
          yAxis: { type: "value" },
          series: [
            {
              data: data.topCategories.map((c) => c.value),
              type: "bar",
              color: "#32CD32",
            },
          ],
        };
        chart.setOption(option);
      }

      // Helper function to extract data from the table
      function extractTableData() {
        const tableRows = document.querySelectorAll("#custom-table tbody tr");
        const data = [];

        tableRows.forEach((row) => {
          const cells = row.querySelectorAll("td");
          const category = cells[0].textContent.trim();
          const value = parseFloat(cells[1].textContent.trim()) || 0;

          if (category) {
            data.push({ category, value });
          }
        });

        // Calculate top categories and contributions
        const totalValue = data.reduce((sum, item) => sum + item.value, 0);
        const sortedData = data.sort((a, b) => b.value - a.value);
        const topCategories = sortedData.slice(0, 3);
        const contributions = data.map((item) => ({
          category: item.category,
          value: item.value,
          percentage: ((item.value / totalValue) * 100).toFixed(2),
        }));

        return { topCategories, contributions };
      }
      // AI Feature 1: Automatically update chart based on trends
      function autoUpdateChart() {
        console.log("Dynamic chart updates enabled.");
        // Example: Automatically refresh the chart every 5 seconds
        window.aiUpdateInterval = setInterval(updateChart, 5000);
      }

      // AI Feature 2: Suggest data for empty cells
      function suggestData() {
        console.log("Data suggestion enabled.");
        const rows = document.querySelectorAll("#custom-table tbody tr");

        rows.forEach((row) => {
          const cells = row.querySelectorAll("td");
          cells.forEach((cell, index) => {
            if (cell.textContent.trim() === "") {
              if (index === 1) {
                // Suggest a value for the "Value" column
                cell.textContent = Math.floor(Math.random() * 1000);
                cell.style.backgroundColor = "#ffffcc"; // Highlight suggestion
              } else if (index === 2) {
                // Suggest a parent category
                cell.textContent = "Suggested Parent";
                cell.style.backgroundColor = "#ffffcc"; // Highlight suggestion
              }
            }
          });
        });
      }

      // AI Feature 3: Highlight errors in the table
      function highlightErrors() {
        console.log("Error highlighting enabled.");
        const rows = document.querySelectorAll("#custom-table tbody tr");

        rows.forEach((row) => {
          const cells = row.querySelectorAll("td");
          const valueCell = cells[1];
          const value = parseFloat(valueCell.textContent.trim());

          if (isNaN(value) || value < 0) {
            // Highlight cells with invalid or negative values
            valueCell.style.backgroundColor = "#ffcccc";
          }
        });
      }

      function performAdvancedAnalysis() {
        console.log("Performing advanced analysis...");
        const tableRows = document.querySelectorAll("#custom-table tbody tr");
        const data = [];

        // Extract data from the table
        tableRows.forEach((row) => {
          const cells = row.querySelectorAll("td");
          const category = cells[0].textContent.trim();
          const value = parseFloat(cells[1].textContent.trim()) || 0;

          if (category) {
            data.push({ category, value });
          }
        });

        if (data.length === 0) {
          alert("No data available for analysis!");
          return;
        }

        // Clear previous insights and chart data
        const insightsList = document.getElementById("insights-list");
        insightsList.innerHTML = ""; // Clear previous insights

        const chartContainer = document.getElementById("chart-container");
        chartContainer.innerHTML =
          '<div id="chart" style="width: 100%; height: 100%;"></div>'; // Reset chart

        // Reinitialize the chart
        const chart = echarts.init(document.getElementById("chart"));

        // Calculate metrics
        const totalValue = data.reduce((sum, item) => sum + item.value, 0);
        const averageValue = totalValue / data.length;
        const values = data.map((item) => item.value);
        const variance =
          values.reduce(
            (sum, value) => sum + Math.pow(value - averageValue, 2),
            0
          ) / data.length;
        const standardDeviation = Math.sqrt(variance);

        // Sort categories
        const sortedData = data.sort((a, b) => b.value - a.value);
        const topCategories = sortedData.slice(0, 3); // Top 3
        const bottomCategories = sortedData.slice(-3); // Bottom 3

        // Calculate contributions
        const contributions = data.map((item) => ({
          category: item.category,
          percentage: ((item.value / totalValue) * 100).toFixed(2),
        }));

        // Insights
        const insights = [];
        insights.push(`Total value across all categories: ${totalValue}.`);
        insights.push(
          `Average value per category: ${averageValue.toFixed(2)}.`
        );
        insights.push(
          `Standard deviation: ${standardDeviation.toFixed(
            2
          )} (indicates data variability).`
        );
        insights.push(
          `Top 3 categories: ${topCategories
            .map((item) => `${item.category} (${item.value})`)
            .join(", ")}.`
        );
        insights.push(
          `Bottom 3 categories: ${bottomCategories
            .map((item) => `${item.category} (${item.value})`)
            .join(", ")}.`
        );

        // Actionable Recommendations
        if (bottomCategories.length > 0) {
          insights.push(
            `Consider reallocating resources from ${bottomCategories
              .map((item) => item.category)
              .join(", ")} to higher-performing categories.`
          );
        }
        if (topCategories.length > 0) {
          insights.push(
            `Focus on expanding ${
              topCategories[0].category
            }, which has the highest contribution of ${
              contributions.find(
                (c) => c.category === topCategories[0].category
              ).percentage
            }% to the total value.`
          );
        }

        // Display Insights with Typing Effect
        displayInsightsWithTyping(insights);

        // Update Chart with Contributions
        const nodes = data.map((item) => ({
          name: `${item.category} (${
            contributions.find((c) => c.category === item.category).percentage
          }%)`,
          value: item.value,
          itemStyle: {
            color: item.value >= averageValue ? "#32CD32" : "#FF5733", // Green for high, red for low
          },
        }));

        chart.setOption({
          series: [
            {
              type: "treemap",
              data: nodes,
            },
          ],
        });
      }

      // Typing Effect Function
      function displayInsightsWithTyping(insights) {
        const insightsList = document.getElementById("insights-list");
        insightsList.innerHTML = ""; // Clear previous content

        let currentInsightIndex = 0;

        // Function to type out a single insight
        function typeInsight(insight, listItem, charIndex = 0) {
          if (charIndex < insight.length) {
            listItem.innerHTML += insight.charAt(charIndex); // Append one character
            setTimeout(() => typeInsight(insight, listItem, charIndex + 1), 10); // Typing speed
          } else {
            // Move to the next insight after a short delay
            currentInsightIndex++;
            if (currentInsightIndex < insights.length) {
              setTimeout(() => typeNextInsight(), 500); // Delay between insights
            }
          }
        }

        // Function to handle the next insight
        function typeNextInsight() {
          const insight = insights[currentInsightIndex];
          const listItem = document.createElement("li"); // Create a new list item
          insightsList.appendChild(listItem); // Add it to the insights list
          typeInsight(insight, listItem); // Start typing the current insight
        }

        // Start typing the first insight
        if (insights.length > 0) {
          typeNextInsight();
        }
      }

      // Clear AI suggestions
      function clearSuggestions() {
        console.log("Clearing AI suggestions.");
        const cells = document.querySelectorAll("#custom-table td");
        cells.forEach((cell) => {
          if (cell.style.backgroundColor === "rgb(255, 255, 204)") {
            cell.style.backgroundColor = ""; // Reset background color
          }
        });
      }

      // Function to display insights
      function displayInsights() {
        const insightsList = document.getElementById("insights-list");
        insights.forEach((insight) => {
          const listItem = document.createElement("li");
          listItem.textContent = insight;
          insightsList.appendChild(listItem);
        });

        // Show the insights section once content is added
        document.getElementById("insights-section").style.display = "block";
      }

      // Call the function to display insights
      displayInsights();
      // Clear error highlights
      function clearHighlights() {
        console.log("Clearing error highlights.");
        const cells = document.querySelectorAll("#custom-table td");
        cells.forEach((cell) => {
          if (cell.style.backgroundColor === "rgb(255, 204, 204)") {
            cell.style.backgroundColor = ""; // Reset background color
          }
        });
      }

      // Stop dynamic updates when AI is disabled
      function disableDynamicUpdates() {
        clearInterval(window.aiUpdateInterval);
      }
    </script>
  </body>
</html>
